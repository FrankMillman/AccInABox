<form name="finrpt_list" title="Financial reports">
  <db_objects>
    <db_obj name="finrpt_defn" table_name="sys_finrpt_defns"/>
  </db_objects>
  <mem_objects>
    <mem_obj name="var" descr="Variables used in form" sub_types="[
        [`date_param`, null,
          [
            [`balance_date`, `Balance date`, [], []],
            [`date_range`, `Date range`, [], []],
            [`fin_yr`, `Financial year`, [`year_no`], []],
            [`start_per`, `Starting period`, [`period_no`], []],
            [`start_date`, `Starting date`, [`starting_date`], []]
            ]
          ]
        ]">
      <mem_col col_name="finrpt_data" data_type="JSON" short_descr="Report definition"
        long_descr="Report definition"/>
      <mem_col col_name="date_param" data_type="TEXT" short_descr="Date type"
        long_descr="Date type" allow_amend="true"/>
      <mem_col col_name="year_no" data_type="INT" short_descr="Year no"
        long_descr="Year no" allow_amend="true" choices = "[]"/>
      <mem_col col_name="period_no" data_type="INT" short_descr="Period no"
        long_descr="Period no" allow_amend="true" choices = "[]"/>
      <mem_col col_name="starting_date" data_type="DTE" short_descr="Starting date"
        long_descr="Starting date" allow_amend="true"/>
      <mem_col col_name="select_location" data_type="BOOL" short_descr="Select location?"
        long_descr="Allow selection of location?" allow_amend="true"/>
      <mem_col col_name="single_location" data_type="BOOL" short_descr="Single location?"
        long_descr="Single location or all locations?" allow_amend="true"/>
      <mem_col col_name="location_row_id" data_type="INT" short_descr="Location row id"
        long_descr="Location row id" allow_amend="true"
        fkey="[`adm_locations`, `row_id`, `location_id`, `location_id`, false, null]"/>
      <mem_col col_name="select_function" data_type="BOOL" short_descr="Select function?"
        long_descr="Allow selection of function?" allow_amend="true"/>
      <mem_col col_name="single_function" data_type="BOOL" short_descr="Single function?"
        long_descr="Single function or all functions?" allow_amend="true"/>
      <mem_col col_name="function_row_id" data_type="INT" short_descr="Function row id"
        long_descr="Function row id" allow_amend="true"
        fkey="[`adm_functions`, `row_id`, `function_id`, `function_id`, false, null]"/>
      <mem_col col_name="local_scale" data_type="INT" short_descr="Local scale"
        long_descr="Scale to use for local currency" dflt_val="{_param.local_curr_id>scale}"/>
      <mem_col col_name="tot_value" data_type="$LCL" short_descr="Total value"
        long_descr="Total value of transactions" db_scale="2" scale_ptr="var.local_scale"/>
    </mem_obj>
    <mem_obj name="balance_date_vars" descr="Variables for balance date">
      <mem_col col_name="settings" data_type="JSON" short_descr="Settings"
        long_descr="Settings, passed between main form and subform" allow_amend="true"/>
      <mem_col col_name="balance_date" data_type="DTE" short_descr="Balance date"
        long_descr="Balance at which date" allow_amend="true"/>
    </mem_obj>
    <mem_obj name="date_range_vars" descr="Variables for date range">
      <mem_col col_name="settings" data_type="JSON" short_descr="Settings"
        long_descr="Settings, passed between main form and subform" allow_amend="true"/>
      <mem_col col_name="start_date" data_type="DTE" short_descr="Date from"
        long_descr="From which date" allow_amend="true"/>
      <mem_col col_name="end_date" data_type="DTE" short_descr="Date to"
        long_descr="To which date" allow_amend="true"/>
    </mem_obj>
    <mem_obj name="tranrpt_obj" descr="In-memory object to hold transaction list for display">
      <mem_col col_name="src_table_name" data_type="TEXT" short_descr="Source table name"
        long_descr="Source table name" col_head="Table"/>
      <mem_col col_name="src_row_id" data_type="INT" short_descr="Source row id"
        long_descr="Source row id" col_head="Row id"/>
      <mem_col col_name="code" data_type="TEXT" short_descr="Code"
        long_descr="Code" col_head="Code"/>
      <mem_col col_name="location_id" data_type="TEXT" short_descr="Location id"
        long_descr="Location id" col_head="Location"/>
      <mem_col col_name="function_id" data_type="TEXT" short_descr="Function id"
        long_descr="Function id" col_head="Function"/>
      <mem_col col_name="tran_date" data_type="DTE" short_descr="Transaction date"
        long_descr="Transaction date" col_head="Date"/>
      <mem_col col_name="tran_type" data_type="TEXT" short_descr="Transaction type"
        long_descr="Transaction type" col_head="Type"/>
      <mem_col col_name="tran_number" data_type="TEXT" short_descr="Transaction number"
        long_descr="Transaction number" col_head="Number"/>
      <mem_col col_name="text" data_type="TEXT" short_descr="Text"
        long_descr="Text" col_head="Text"/>
      <mem_col col_name="value" data_type="$LCL" short_descr="Value"
        long_descr="Value" col_head="Value" db_scale="2" scale_ptr="var.local_scale"/>
    </mem_obj>
  </mem_objects>
  <input_params/>
  <output_params/>
  <frame main_object="finrpt_defn">
    <toolbar/>
    <body>
      <block/>
      <grid data_object="finrpt_defn" growable="false" cursor_name="finrpt_list">
        <toolbar>
          <tool type="img" name="formview" tip="Form view (Ctrl+Enter)" action="
            <<req_formview/>>
            " shortcut="ctrl,Enter"/>
          <tool type="nav"/>
          <tool type="img" name="download" action="<<download/>>"/>
        </toolbar>
        <grid_methods template="Grid">
        </grid_methods>
      </grid>
    </body>
    <button_row/>
    <frame_methods template="Grid"/>
  </frame>
</form>
